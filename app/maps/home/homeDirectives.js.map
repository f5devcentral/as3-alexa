{"version":3,"sources":["home/homeDirectives.js"],"names":["angular","module","$window","directive","scope","data","restrict","element","attrs","link","$watch","attr","d3","rawSvg","d","source","x","svg","select","width","height","tip","offset","html","group","id","y","name","call","dragstarted","transition","duration","style","remove","selectAll","fx","simulation","root","fixed","forceSimulation","force","forceLink","distance","target","forceManyBody","strength","graph","forceCenter","forceCollide","radius","append","links","enter","node","circle","nodes","status","on","show","hide","drag","event","active","alphaTarget","restart","fy","txt","text","Math","max","min"],"mappings":"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","file":"../../components/home/homeDirectives.js","sourcesContent":["/*\n * Copyright (c) 2018, F5 Networks, Inc. All rights reserved.\n * No part of this software may be reproduced or transmitted in any\n * form or by any means, electronic or mechanical, for any purpose,\n * without express written permission of F5 Networks, Inc.\n */\n(function () {\n\n    /* Home Directives */\n    angular.module('homeDirectives', []).\n    // Example Bubble Chart\n    directive('customGraph', function ($window) {\n        return {\n            restrict: 'EA',\n            scope: {data: '='},\n            templateUrl: 'partials/templates/graph.html',\n            link: function (scope, element, attrs) {\n\n                scope.$watch('data', function (data) {\n                    if (data) {\n                        // Look for responsive svg solution later!\n                        // var width = window.innerWidth;\n                        // var height = window.innerHeight;\n                        const d3 = $window.d3;\n                        const rawSvg = element.find('svg');\n                        const svg = d3.select(rawSvg[0]);\n                        const width = svg.attr('width');\n                        const height = svg.attr('height');\n                        const tip = d3.tip().\n                attr('class', 'd3-tip').\n                offset([-10, 0]).\n                html(function (d) {\n                    if (d.group === 50) {\n                        return `<span>${d.id}</span>`;\n                    } else if (d.group === 40) {\n                        return `<strong>Tenant:</strong><span>${d.id}</span>`;\n                    } else if (d.group === 30) {\n                        return `<strong>Application:</strong><span>${d.id}</span>`;\n                    } else if (d.group === 20) {\n                        return `<strong>Service:</strong><span>${d.id}</span>`;\n                    } else if (d.group === 15) {\n                        return `<strong>Virtual Server:</strong><span>${d.id}</span>`;\n                    } else if (d.group === 10) {\n                        return `<strong>Pool:</strong><span>${d.id}</span>`;\n                    } else if (d.group === 5) {\n                        return `<strong>Pool Member:</strong><span>${d.ip}</span>`;\n                    } else if (d.group === 3) {\n                        return `<strong>SERVER:</strong> <span>${d.name}</span>`;\n                    }\n\n                });\n                        svg.call(tip);\n\n                        // .attr('viewBox','0 0 '+Math.min(width,height) +' '+Math.min(width,height) )\n                        // .attr('preserveAspectRatio','xMinYMin')\n                        // .append(\"g\")\n                        // .attr(\"transform\", \"translate(\" + Math.min(width,height) / 2 + \",\" + Math.min(width,height) / 2 + \")\");\n\n                        // Remove all elements before redrawing graph\n                        svg.selectAll('circle').\n                transition().\n                duration(750).\n                style('opacity', 0).\n                remove();\n\n                        svg.selectAll('line').\n                transition().\n                duration(750).\n                style('opacity', 0).\n                remove();\n\n                        svg.selectAll('text').\n                transition().\n                duration(750).\n                style('opacity', 0).\n                remove();                \n\n                        svg.\n                transition().\n                duration(750).\n                style('opacity', 1);\n\n                        // Grid Layout ===============================================================\n                        const graph = data;\n                        const nodes = graph.nodes;\n                        const links = graph.links;\n\n\n                        // Root node\n                        const root = graph.nodes[0];\n\n                        root.x = width / 2;\n                        root.y = height / 2;\n                        root.fixed = true;\n\n\n                        const simulation = d3.forceSimulation().\n                force('link', d3.forceLink().\n                  id(function (d) {\n                      return d.id;\n                  }).\n                  distance(function (d) {\n                      if (d.source.group === 50 && d.target.group === 40) {\n                          return 60; \n                      } else if (d.source.group === 40 || d.source.group === 30||\n                               d.source.group === 20 || d.source.group === 15 && \n                               d.target.group === 40 || d.target.group === 30 || \n                               d.target.group === 20 || d.target.group === 15                              \n                      ) \n                      {\n                          return 45;\n                      } else if (d.source.group === 10 || d.source.group === 5 && d.target.group === 10 || d.target.group === 5) {\n                          return 40;\n                      }\n                  })).\n\n                force('charge', d3.forceManyBody().strength(function (d) {\n                    if (d.group === 50) {\n                        return -60;\n                    } else if (d.group === 40) {\n                        return -50;\n                    } else if (d.group === 30) {\n                        return -40;\n                    }\n                    return -30;\n\n                })).\n                force('center', d3.forceCenter(width / 2, height / 2)).\n                force('collide', d3.forceCollide().radius(function (d) {\n                    if (d.group === 50) { // Big IP\n                        return 30;\n                    } else if (d.group === 40) { // Tenant\n                        return 20;\n                    } else if (d.group === 30) { // Application\n                        return 15;\n                    } else if (d.group === 20) { // Service\n                        return 10;\n                    }\n                    return 8;\n\n\n                }));\n\n\n                        const link = svg.append('g').\n                attr('class', 'links').\n                selectAll('line').\n                data(links).\n                enter().append('line').\n                attr('stroke-width', function (d) {\n                    return 2;\n                });\n\n                        const node = svg.append('g').\n                attr('class', 'node');\n\n\n                        const circle = node.selectAll('circle').\n                data(nodes).\n                enter().append('circle').\n                attr('r', function (d) {\n                    if (d.group === 50) { // Big IP\n                        return 25;\n                    } else if (d.group === 40) {\n                        return 16;\n                    } else if (d.group === 30) {\n                        return 15;\n                    } else if (d.group === 20) { // Tenants\n                        return 14;\n                    } else if (d.group === 15) {\n                        return 13;\n                    } else if (d.group === 10) {\n                        return 12;\n                    } else if (d.group === 5) { // Nodes \n                        return 10;\n                    }\n                    return 6;\n\n                }).\n                attr('fill', function (d) {\n                    // Change color of node balls according to status \n                    // Some proxy has \"authorize\" as status although status should only be authorized\n                    // Big-IP has distinct color\n                    if (d.group === 50) {\n                        return '#c7062b'; // BIG IP Ball\n                    } else if (d.group === 40) {\n                        return '#0f71b9';\n                    } else if (d.group === 30) {\n                        return '#0aa6ea';\n                    } else if (d.group === 20) {\n                        return '#3dc1f9';\n                    } else if (d.group === 15) {\n                        return '#6fd4ff';\n                    } else if (d.group === 10) {\n                        return '#97e0ff';\n                    } else if (d.group === 5) {\n                        if (d.status === 'offline' || d.status === ' ' || d.status === '') {\n                            return '#e21c1c';\n                        } else if (d.status === 'online') {\n                            return '#3d9e3d';\n                        }\n                    }\n                }).\n                attr('class', function (d) {\n                    if (d.id === 'BIG IP') {\n                        return 'fixed-node';\n                    }\n                }).\n                on('mouseover', tip.show).\n                on('mouseout', tip.hide).\n                call(d3.drag().\n                  on('start', dragstarted).\n                  on('drag', dragged).\n                  on('end', dragended));\n\n                        const txt = node.selectAll('text').\n                data(graph.nodes).\n                enter().append('text').\n                text(function (d) {\n                    if (d.group === 50) {\n                        return d.id;\n                    } else if (d.group === 40) {\n                        return 'T';\n                    } else if (d.group === 30) {\n                        return 'A';\n                    } else if (d.group === 20) {\n                        return 'S';\n                    } else if (d.group === 15) {\n                        return 'V';\n                    } else if (d.group === 10) {\n                        return 'P';\n                    } else if (d.group === 5) {\n                        return 'M';\n                    }\n\n                })\n                .style('fill', 'white')\n                .style('font-size', '10px');\n\n\n                        simulation.\n                nodes(graph.nodes).\n                on('tick', ticked);\n\n\n                        simulation.force('link').\n                links(graph.links);\n\n                        function ticked () {\n                            link.\n                  attr('x1', function (d) {\n                      return d.source.x;\n                  }).\n                  attr('y1', function (d) {\n                      return d.source.y;\n                  }).\n                  attr('x2', function (d) {\n                      return d.target.x;\n                  }).\n                  attr('y2', function (d) {\n                      return d.target.y;\n                  });\n\n                            circle.\n                  attr('cx', function (d) {\n                      return d.x = Math.max(10, Math.min(width - 10, d.x));\n                  }).\n                  attr('cy', function (d) {\n                      return d.y = Math.max(10, Math.min(height - 10, d.y));\n                  });\n\n                            txt.\n                  attr('x', function (d) {\n                      // Adding x and y only for BIG IP for now\n                      if (d.group === 50) {\n                          return d.x - 16;\n                      } else if (d.group === 40 || d.group === 30 || d.group === 20 || d.group === 15) {\n                          return d.x - 3;\n                      } else if (d.group === 10 || d.group === 5) {\n                          return d.x - 3;\n                      }\n\n                  }).\n                  attr('y', function (d) {\n                      if (d.group === 50) {\n                          return d.y + 3;\n                      } else if (d.group === 40 || d.group === 30 || d.group === 20 || d.group === 15) {\n                          return d.y + 3;\n                      } else if (d.group === 10 || d.group === 5) {\n                          return d.y + 3;\n                      }\n\n                  });\n\n                        }\n\n                        function dragstarted (d) {\n                            if (!d3.event.active) {\n                                simulation.alphaTarget(0.3).restart();\n                            }\n                            d.fx = d.x;\n                            d.fy = d.y;\n                        }\n\n                        function dragged (d) {\n                            d.fx = d3.event.x;\n                            d.fy = d3.event.y;\n                        }\n\n                        function dragended (d) {\n                            if (!d3.event.active) {\n                                simulation.alphaTarget(0);\n                            }\n                            d.fx = null;\n                            d.fy = null;\n                        }\n                    }\n                });\n\n\n            }\n        };\n    });\n}());"]}