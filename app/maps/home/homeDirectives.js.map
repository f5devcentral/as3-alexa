{"version":3,"sources":["home/homeDirectives.js"],"names":["angular","module","$window","directive","scope","data","restrict","element","attrs","link","$watch","attr","d3","rawSvg","d","source","x","svg","select","width","height","tip","offset","html","group","circle","id","max","JSON","stringify","schema","undefined","y","call","dragstarted","transition","duration","simulation","style","remove","selectAll","dragged","fx","event","root","fixed","forceSimulation","force","distance","target","ip","forceManyBody","strength","nodes","graph","links","enter","node","append","status","on","show","hide","drag","active","alphaTarget","restart","fy","txt","text","Math","min"],"mappings":"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","file":"../../components/home/homeDirectives.js","sourcesContent":["/**\n * Copyright (c) 2018, F5 Networks, Inc. \n */\n\n(function() {\n\n    /* Home Directives */\n    angular.module('homeDirectives', []).\n    // Example Bubble Chart\n    directive('customGraph', function($window) {\n        return {\n            restrict: 'EA',\n            scope: { data: '=' },\n            templateUrl: 'partials/templates/graph.html',\n            link: function(scope, element, attrs) {\n\n                scope.$watch('data', function(data) {\n                    if (data) {\n                        // Look for responsive svg solution later!\n                        // var width = window.innerWidth;\n                        // var height = window.innerHeight;\n                        const d3 = $window.d3;\n                        const rawSvg = element.find('svg');\n                        const svg = d3.select(rawSvg[0]);\n                        const width = svg.attr('width');\n                        const height = svg.attr('height');\n                        const tip = d3.tip().\n                        attr('class', 'd3-tip').\n                        offset([-10, 0]).\n                        html(function(d) {\n                            if (d.group === 50) {\n                                return `<span>${d.id}</span>`;\n                            } else if (d.group === 40) {\n                                return `<pre>Tenant:<span>${d.id}</span><code>${JSON.stringify(d.schema, undefined, 2)}</code></pre>`;\n                            } else if (d.group === 30) {\n                                return `<pre>Application:<span>${d.id}</span><code>${JSON.stringify(d.schema, undefined, 2)}</code></pre>`;\n                            } else if (d.group === 20) {\n                                return `<pre>Service:<span>${d.id}</span><pre><code>${JSON.stringify(d.schema, undefined, 2)}</code></pre>`;\n                            } else if (d.group === 15) {\n                                return `<pre>Virtual Server:<span>${d.id}</span><code>${JSON.stringify(d.schema, undefined, 2)}</code></pre>`;\n                            } else if (d.group === 10) {\n                                return `<pre>Pool:<span>${d.id}</span><code>${JSON.stringify(d.schema, undefined, 2)}</code></pre>`;\n                            } else if (d.group === 5) {\n                                return `<pre>Pool Member:<span>${d.ip}</span><code>${JSON.stringify(d.schema, undefined, 2)}</code></pre>`;\n                            }\n\n                        });\n\n\n                        svg.call(tip);\n\n                        // .attr('viewBox','0 0 '+Math.min(width,height) +' '+Math.min(width,height) )\n                        // .attr('preserveAspectRatio','xMinYMin')\n                        // .append(\"g\")\n                        // .attr(\"transform\", \"translate(\" + Math.min(width,height) / 2 + \",\" + Math.min(width,height) / 2 + \")\");\n\n                        // Remove all elements before redrawing graph\n                        svg.selectAll('circle').\n                        transition().\n                        duration(750).\n                        style('opacity', 0).\n                        remove();\n\n                        svg.selectAll('line').\n                        transition().\n                        duration(750).\n                        style('opacity', 0).\n                        remove();\n\n                        svg.selectAll('text').\n                        transition().\n                        duration(750).\n                        style('opacity', 0).\n                        remove();\n\n                        svg.\n                        transition().\n                        duration(750).\n                        style('opacity', 1);\n\n                        // Grid Layout ===============================================================\n                        const graph = data;\n                        const nodes = graph.nodes;\n                        const links = graph.links;\n\n\n                        // Root node\n                        const root = graph.nodes[0];\n\n                        root.x = width / 2;\n                        root.y = height / 2;\n                        root.fixed = true;\n\n\n                        const simulation = d3.forceSimulation().\n                        force('link', d3.forceLink().id(function(d) {\n                            return d.id;\n                        }).distance(function(d) {\n                            if (d.source.group === 50 && d.target.group === 40) {\n                                return 60;\n                            } else if (d.source.group === 40 || d.source.group === 30 ||\n                                d.source.group === 20 || d.source.group === 15 &&\n                                d.target.group === 40 || d.target.group === 30 ||\n                                d.target.group === 20 || d.target.group === 15\n                            ) {\n                                return 45;\n                            } else if (d.source.group === 10 || d.source.group === 5 && d.target.group === 10 || d.target.group === 5) {\n                                return 40;\n                            }\n                        })).\n\n                        force('charge', d3.forceManyBody().strength(function(d) {\n                            if (d.group === 50) {\n                                return -60;\n                            } else if (d.group === 40) {\n                                return -50;\n                            } else if (d.group === 30) {\n                                return -40;\n                            }\n                            return -30;\n\n                        })).\n                        force('center', d3.forceCenter(width / 2, height / 2)).\n                        force('collide', d3.forceCollide().radius(function(d) {\n                            if (d.group === 50) { // Big IP\n                                return 30;\n                            } else if (d.group === 40) { // Tenant\n                                return 20;\n                            } else if (d.group === 30) { // Application\n                                return 15;\n                            } else if (d.group === 20) { // Service\n                                return 10;\n                            }\n                            return 8;\n\n\n                        }));\n\n\n                        const link = svg.append('g').\n                        attr('class', 'links').\n                        selectAll('line').\n                        data(links).\n                        enter().append('line').\n                        attr('stroke-width', function(d) {\n                            return 2;\n                        });\n\n                        const node = svg.append('g').\n                        attr('class', 'node');\n\n\n                        const circle = node.selectAll('circle').\n                        data(nodes).\n                        enter().append('circle').\n                        attr('r', function(d) {\n                            if (d.group === 50) { // Big IP\n                                return 25;\n                            } else if (d.group === 40) {\n                                return 16;\n                            } else if (d.group === 30) {\n                                return 15;\n                            } else if (d.group === 20) { // Tenants\n                                return 14;\n                            } else if (d.group === 15) {\n                                return 13;\n                            } else if (d.group === 10) {\n                                return 12;\n                            } else if (d.group === 5) { // Nodes \n                                return 10;\n                            }\n                            return 6;\n\n                        }).\n                        attr('fill', function(d) {\n                            // Change color of node balls according to status \n                            // Some proxy has \"authorize\" as status although status should only be authorized\n                            // Big-IP has distinct color\n                            if (d.group === 50) {\n                                return '#c7062b'; // BIG IP Ball\n                            } else if (d.group === 40) {\n                                return '#0f71b9';\n                            } else if (d.group === 30) {\n                                return '#0aa6ea';\n                            } else if (d.group === 20) {\n                                return '#3dc1f9';\n                            } else if (d.group === 15) {\n                                return '#6fd4ff';\n                            } else if (d.group === 10) {\n                                return '#97e0ff';\n                            } else if (d.group === 5) {\n                                if (d.status === 'offline' || d.status === ' ' || d.status === '') {\n                                    return '#e21c1c';\n                                } else if (d.status === 'online') {\n                                    return '#3d9e3d';\n                                }\n                            }\n                        }).\n                        attr('class', function(d) {\n                            if (d.id === 'BIG IP') {\n                                return 'fixed-node';\n                            }\n                        }).\n                        on('mouseover', function(d) {\n                            var x = d3.event.x + 100 + 'px',\n                                y = d3.event.y + 50 + 'px';\n\n                            tip.show(d);\n\n                            tip.style('top', y);\n                            tip.style('left', x);\n                        }).\n                        on('mouseout', tip.hide).\n                        call(d3.drag().on('start', dragstarted).on('drag', dragged).on('end', dragended));\n\n                        const txt = node.selectAll('text').\n                        data(graph.nodes).\n                        enter().append('text').\n                        text(function(d) {\n                                if (d.group === 50) {\n                                    return d.id;\n                                } else if (d.group === 40) {\n                                    return 'T';\n                                } else if (d.group === 30) {\n                                    return 'A';\n                                } else if (d.group === 20) {\n                                    return 'S';\n                                } else if (d.group === 15) {\n                                    return 'V';\n                                } else if (d.group === 10) {\n                                    return 'P';\n                                } else if (d.group === 5) {\n                                    return 'M';\n                                }\n\n                            })\n                            .style('fill', 'white')\n                            .style('font-size', '10px');\n\n\n                        simulation.\n                        nodes(graph.nodes).\n                        on('tick', ticked);\n\n\n                        simulation.force('link').\n                        links(graph.links);\n\n                        function ticked() {\n                            link.\n                            attr('x1', function(d) {\n                                return d.source.x;\n                            }).\n                            attr('y1', function(d) {\n                                return d.source.y;\n                            }).\n                            attr('x2', function(d) {\n                                return d.target.x;\n                            }).\n                            attr('y2', function(d) {\n                                return d.target.y;\n                            });\n\n                            circle.\n                            attr('cx', function(d) {\n                                return d.x = Math.max(10, Math.min(width - 10, d.x));\n                            }).\n                            attr('cy', function(d) {\n                                return d.y = Math.max(10, Math.min(height - 10, d.y));\n                            });\n\n                            txt.\n                            attr('x', function(d) {\n                                // Adding x and y only for BIG IP for now\n                                if (d.group === 50) {\n                                    return d.x - 16;\n                                } else if (d.group === 40 || d.group === 30 || d.group === 20 || d.group === 15) {\n                                    return d.x - 3;\n                                } else if (d.group === 10 || d.group === 5) {\n                                    return d.x - 3;\n                                }\n\n                            }).\n                            attr('y', function(d) {\n                                if (d.group === 50) {\n                                    return d.y + 3;\n                                } else if (d.group === 40 || d.group === 30 || d.group === 20 || d.group === 15) {\n                                    return d.y + 3;\n                                } else if (d.group === 10 || d.group === 5) {\n                                    return d.y + 3;\n                                }\n\n                            });\n\n                        }\n\n                        function dragstarted(d) {\n                            if (!d3.event.active) {\n                                simulation.alphaTarget(0.3).restart();\n                            }\n                            d.fx = d.x;\n                            d.fy = d.y;\n                        }\n\n                        function dragged(d) {\n                            d.fx = d3.event.x;\n                            d.fy = d3.event.y;\n                        }\n\n                        function dragended(d) {\n                            if (!d3.event.active) {\n                                simulation.alphaTarget(0);\n                            }\n                            d.fx = null;\n                            d.fy = null;\n                        }\n                    }\n                });\n\n\n            }\n        };\n    });\n}());"]}